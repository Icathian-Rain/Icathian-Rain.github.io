<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>mit 6.583 lab0 | IcathianRain's Blog</title><meta name="author" content="IcathianRain"><meta name="copyright" content="IcathianRain"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="task1Start an http server and handle requests Q: This task requires you to start up the http server in main.go and handle the user’s GET requests by filling out the HomeHandler method in handlers&amp;#x2F">
<meta property="og:type" content="article">
<meta property="og:title" content="mit 6.583 lab0">
<meta property="og:url" content="https://blog.icathianrain.me/2023/12/21/mit-6583-lab0/index.html">
<meta property="og:site_name" content="IcathianRain&#39;s Blog">
<meta property="og:description" content="task1Start an http server and handle requests Q: This task requires you to start up the http server in main.go and handle the user’s GET requests by filling out the HomeHandler method in handlers&amp;#x2F">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.icathianrain.me/images/avatar.jpg">
<meta property="article:published_time" content="2023-12-21T16:37:00.000Z">
<meta property="article:modified_time" content="2024-01-12T09:17:16.585Z">
<meta property="article:author" content="IcathianRain">
<meta property="article:tag" content="golang">
<meta property="article:tag" content="databases">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.icathianrain.me/images/avatar.jpg"><link rel="shortcut icon" href="/images/avatar.jpg"><link rel="canonical" href="https://blog.icathianrain.me/2023/12/21/mit-6583-lab0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'mit 6.583 lab0',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-12 09:17:16'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4179705_k5qmnhfql49.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"/><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://fqh.yllhwa.com/js/Meting.min.js"></script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类页</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="IcathianRain's Blog"><span class="site-name">IcathianRain's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类页</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">mit 6.583 lab0</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-12-21T16:37:00.000Z" title="发表于 2023-12-21 16:37:00">2023-12-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-12T09:17:16.585Z" title="更新于 2024-01-12 09:17:16">2024-01-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Knowledge/">Knowledge</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="mit 6.583 lab0"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="task1"><a href="#task1" class="headerlink" title="task1"></a>task1</h1><p>Start an http server and handle requests</p>
<h2 id="Q"><a href="#Q" class="headerlink" title="Q:"></a>Q:</h2><blockquote>
<p>This task requires you to start up the http server in main.go and handle the user’s GET requests by filling out the HomeHandler method in handlers&#x2F;handlers.go.<br>The final web app looks like in the screenshot below, where users can select a T line (e.g. red line) and display its ridership statistics in a bar chart. The HomeHandler function first checks which line the user has selected in the drop down menu and then queries ridership numbers for that line from a RiderhipDB instance. The returned values are then displayed in a bar chart. You don’t need to write code to plot the bar chart yourself, you can simply use the GenerateBarChart function in utils&#x2F;render_chart.go.<br>After completing this task, you should be able to start the web server by running go run main.go and see the web app in your browser by going to <a href="http://localhost:PORT">http://localhost:PORT</a> (where PORT is the port number you specified):</p>
</blockquote>
<p>此任务要求您在main.go中启动http服务器，并通过在handlers&#x2F;handlers.go中填写HomeHandler方法来处理用户的GET请求。<br>最终的web应用程序如下面的屏幕截图所示，用户可以选择T线 (例如红线) 并在条形图中显示其乘客人数统计信息。HomeHandler函数首先检查用户在下拉菜单中选择了哪一行，然后从RiderhipDB实例中查询该行的载客号。然后将返回的值显示在条形图中。你不需要自己编写代码来绘制条形图，你可以简单地在utils&#x2F;render_chart.go中使用GenerateBarChart函数。<br>完成此任务后，您应该能够通过运行go run main来启动web服务器。转到http:&#x2F;&#x2F; localhost:PORT (其中PORT是您指定的端口号)，然后在浏览器中查看web应用程序。</p>
<h2 id="TODO1-读取数据"><a href="#TODO1-读取数据" class="headerlink" title="TODO1: 读取数据"></a>TODO1: 读取数据</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// Get the chart data from RidershipDB</span></span><br><span class="line"></span><br><span class="line">db.Open(<span class="string">&quot;C:\\Users\\22057\\Documents\\Study\\MIT_s6583\\mbta.sqlite&quot;</span>)</span><br><span class="line"><span class="comment">// db.Open(&quot;C:\\Users\\22057\\Documents\\Study\\MIT_s6583\\lab\\lab0\\mbta.csv&quot;)</span></span><br><span class="line">chart_data, err := db.GetRidership(selectedChart)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打开数据库，并从数据库中读取Ridership数据</p>
<h2 id="TODO2：将数据转为条形图"><a href="#TODO2：将数据转为条形图" class="headerlink" title="TODO2：将数据转为条形图"></a>TODO2：将数据转为条形图</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// Plot the bar chart using utils.GenerateBarChart. The function will return the bar chart</span></span><br><span class="line"><span class="comment">// as PNG byte slice. Convert the bytes to a base64 string, which is used to embed images in HTML.</span></span><br><span class="line">bar_chart, err := utils.GenerateBarChart(chart_data)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line">bar_chart = []<span class="type">byte</span>(base64.StdEncoding.EncodeToString(bar_chart))</span><br></pre></td></tr></table></figure>
<p>将读取的数据转换为条形图，并进行base64转换</p>
<h2 id="TODO3：数据嵌入返回"><a href="#TODO3：数据嵌入返回" class="headerlink" title="TODO3：数据嵌入返回"></a>TODO3：数据嵌入返回</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// We now want to create a struct to hold the values we want to embed in the HTML</span></span><br><span class="line">data := <span class="keyword">struct</span> &#123;</span><br><span class="line">    Image <span class="type">string</span></span><br><span class="line">    Chart <span class="type">string</span></span><br><span class="line">&#125;&#123;</span><br><span class="line">    Image: <span class="type">string</span>(bar_chart), <span class="comment">// <span class="doctag">TODO:</span> base64 string</span></span><br><span class="line">    Chart: selectedChart,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// Use tmpl.Execute to generate the final HTML output and send it as a response</span></span><br><span class="line"><span class="comment">// to the client&#x27;s request.</span></span><br><span class="line">tmpl.Execute(w, data)</span><br></pre></td></tr></table></figure>
<p>构造数据，并将其嵌入html中返回</p>
<h2 id="TODO4：HTTP服务"><a href="#TODO4：HTTP服务" class="headerlink" title="TODO4：HTTP服务"></a>TODO4：HTTP服务</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// Fill out the HomeHandler function in handlers/handlers.go which handles the user&#x27;s GET request.</span></span><br><span class="line"><span class="comment">// Start an http server using http.ListenAndServe that handles requests using HomeHandler.</span></span><br><span class="line">fmt.Println(<span class="string">&quot;start server&quot;</span>)</span><br><span class="line">http.HandleFunc(<span class="string">&quot;/&quot;</span>, handlers.HomeHandler)</span><br><span class="line">http.ListenAndServe(<span class="string">&quot;127.0.0.1:6670&quot;</span>, <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>
<p>将&#x2F;目录与响应函数绑定<br>启动HTTP服务</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>测试结果，通过</p>
<img src="/2023/12/21/mit-6583-lab0/1703034163656-336bb55a-e3d1-4eff-adf1-a0f58107ae8d.png" class="" title="image.png">
<h2 id="仓库地址"><a href="#仓库地址" class="headerlink" title="仓库地址"></a>仓库地址</h2><p><a target="_blank" rel="noopener" href="https://github.com/Icathian-Rain/lab0/tree/task1">https://github.com/Icathian-Rain/lab0/tree/task1</a></p>
<h1 id="task2"><a href="#task2" class="headerlink" title="task2"></a>task2</h1><h2 id="Q-1"><a href="#Q-1" class="headerlink" title="Q:"></a>Q:</h2><blockquote>
<p>This task requires you to implement the missing methods in ridership_db&#x2F;csv_ridership_db.go<br>Instead of issuing the query against sqlite, CsvRidershipDB directly runs it over the mbta.csv CSV file. MBTA divides a day into nine different time periods (<em>time_period_01</em>, …, <em>time_period_09</em>). The CSV file contains how many passengers boarded trains during a specific time period, at a specific station and for a specific line and direction. For the queried line (passed to GetRidership) compute the total number of passengers that boarded a train for each given time period (for each time period, sum over all stations and directions). The sum for each time period should be an entry in the returned int64 slice. Make sure to use the idIdxMap map to map the time period id strings (e.g. <em>time_period_01</em>) to the correct index in the boardings slice (e.g. 0).<br>To use your CSV implementation in the web app, instantiate RidershipDB to be a CsvRidershipDB instead of a SqliteRidershipDB in lines 23-24 in handlers&#x2F;handlers.go:</p>
</blockquote>
<p>此任务要求您实现 ridership_db&#x2F;csv_ridership_db.go 中缺少的方法 CsvRidershipDB 不是针对 sqlite 发出查询，而是直接在 mbta.csv CSV 文件上运行查询。 MBTA 将一天分为九个不同的时间段 (time_period_01, …, time_period_09)。 CSV 文件包含在特定时间段、特定车站、特定线路和方向登上火车的乘客数量。对于查询的线路（传递给 GetRidership），计算每个给定时间段内登上火车的乘客总数（对于每个时间段，所有车站和方向的总和）。每个时间段的总和应该是返回的 int64 切片中的一个条目。确保使用 idIdxMap 映射将时间段 ID 字符串（例如 time_period_01）映射到登机切片中的正确索引（例如 0）。 要在 Web 应用程序中使用 CSV 实现，请在 handlers&#x2F;handlers.go 中的第 23-24 行中将 RidershipDB 实例化为 CsvRidershipDB，而不是 SqliteRidershipDB：</p>
<h2 id="TODO1-实现GetRidership方法"><a href="#TODO1-实现GetRidership方法" class="headerlink" title="TODO1: 实现GetRidership方法"></a>TODO1: 实现GetRidership方法</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> some code goes here</span></span><br><span class="line"><span class="comment">// Implement the remaining RidershipDB methods</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CsvRidershipDB)</span></span> GetRidership(lineId <span class="type">string</span>) ([]<span class="type">int64</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="comment">// return res</span></span><br><span class="line">	<span class="keyword">var</span> res = <span class="built_in">make</span>([]<span class="type">int64</span>, <span class="number">9</span>)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		record, err := c.csvReader.Read()</span><br><span class="line">		<span class="comment">// if record == nil, there is no more record, break</span></span><br><span class="line">		<span class="keyword">if</span> record == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="built_in">panic</span>(err.Error())</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// sum the ons</span></span><br><span class="line">		<span class="keyword">if</span> record[<span class="number">0</span>] == lineId &#123;</span><br><span class="line">			<span class="comment">// time_period_0i -&gt; idx = i-1</span></span><br><span class="line">			idx := c.idIdxMap[record[<span class="number">2</span>]]</span><br><span class="line">			ons, _ := strconv.Atoi(record[<span class="number">4</span>])</span><br><span class="line">			res[idx] += <span class="type">int64</span>(ons)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从csv中按条读入数据<br>record[0]为线路id<br>record[2]为时间段<br>record[4]为ons<br>统计各个时间段的ons总和<br>将数据存入数据对应部分</p>
<h2 id="TODO2-close方法"><a href="#TODO2-close方法" class="headerlink" title="TODO2: close方法"></a>TODO2: close方法</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CsvRidershipDB)</span></span> Close() <span class="type">error</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h2><img src="/2023/12/21/mit-6583-lab0/1703034732458-0ca42688-e2c2-4acf-b4da-b8d36eae5a70.png" class="" title="image.png">
<p>对各个线路进行测试，测试通过</p>
<h2 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h2><p><a target="_blank" rel="noopener" href="https://github.com/Icathian-Rain/lab0/tree/task2">https://github.com/Icathian-Rain/lab0/tree/task2</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.icathianrain.me">IcathianRain</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.icathianrain.me/2023/12/21/mit-6583-lab0/">https://blog.icathianrain.me/2023/12/21/mit-6583-lab0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.icathianrain.me" target="_blank">IcathianRain's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/golang/">golang</a><a class="post-meta__tags" href="/tags/databases/">databases</a></div><div class="post_share"><div class="social-share" data-image="/images/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/12/mit-6583-lab1K/" title="mit 6583 lab1K"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">mit 6583 lab1K</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/24/axios-and-fetch/" title="axios and fetch"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">axios and fetch</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/01/12/mit-6583-lab1E/" title="mit 6583 lab1E"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-12</div><div class="title">mit 6583 lab1E</div></div></a></div><div><a href="/2024/01/12/mit-6583-lab1K/" title="mit 6583 lab1K"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-12</div><div class="title">mit 6583 lab1K</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">IcathianRain</div><div class="author-info__description">今夜，我是天选，也是唯一。I was gonna be that one in a million.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Icathian-Rain"><i class="fab fa-github"></i><span>关注</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Icathian-Rain" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/47310416" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili" style="color: #20B0E3;"></i></a><a class="social-icon" href="mailto:2205794866@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#task1"><span class="toc-text">task1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Q"><span class="toc-text">Q:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO1-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-text">TODO1: 读取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO2%EF%BC%9A%E5%B0%86%E6%95%B0%E6%8D%AE%E8%BD%AC%E4%B8%BA%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-text">TODO2：将数据转为条形图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO3%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%B5%8C%E5%85%A5%E8%BF%94%E5%9B%9E"><span class="toc-text">TODO3：数据嵌入返回</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO4%EF%BC%9AHTTP%E6%9C%8D%E5%8A%A1"><span class="toc-text">TODO4：HTTP服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-text">测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80"><span class="toc-text">仓库地址</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#task2"><span class="toc-text">task2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Q-1"><span class="toc-text">Q:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO1-%E5%AE%9E%E7%8E%B0GetRidership%E6%96%B9%E6%B3%95"><span class="toc-text">TODO1: 实现GetRidership方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO2-close%E6%96%B9%E6%B3%95"><span class="toc-text">TODO2: close方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-text">测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%93%E5%BA%93"><span class="toc-text">仓库</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/12/mit-6583-lab1E/" title="mit 6583 lab1E">mit 6583 lab1E</a><time datetime="2024-01-12T11:32:40.000Z" title="发表于 2024-01-12 11:32:40">2024-01-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/12/mit-6583-lab1K/" title="mit 6583 lab1K">mit 6583 lab1K</a><time datetime="2024-01-12T11:30:31.000Z" title="发表于 2024-01-12 11:30:31">2024-01-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/12/21/mit-6583-lab0/" title="mit 6.583 lab0">mit 6.583 lab0</a><time datetime="2023-12-21T16:37:00.000Z" title="发表于 2023-12-21 16:37:00">2023-12-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/24/axios-and-fetch/" title="axios and fetch">axios and fetch</a><time datetime="2023-11-24T12:26:37.000Z" title="发表于 2023-11-24 12:26:37">2023-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/13/google-search/" title="google search">google search</a><time datetime="2023-11-13T16:07:26.000Z" title="发表于 2023-11-13 16:07:26">2023-11-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By IcathianRain</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script> var meting_api='https://api.injahow.cn/meting/?server=:server&type=:type&id=:id&auth=:auth&r=:r';</script><meting-js server="tencent" type="playlist" id="9070810982" fixed="true" path="https://fqh.yllhwa.com/music/"></meting-js><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>